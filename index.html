<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NWN Media</title>
  <link rel="icon" type="image/svg+xml" href="/nwnmedia.svg" />
  <style>
    :root {
      --bg: #0c0f15;
      --panel: #121722;
      --panel-soft: #1a2130;
      --text: #f3f6ff;
      --muted: #a3aec9;
      --accent: #6fe3ff;
      --accent-strong: #48b9ff;
      --ok: #4bffb0;
      --border: #293349;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background:
        radial-gradient(circle at top right, rgba(15, 175, 255, 0.22), transparent 35%),
        radial-gradient(circle at top left, rgba(15, 175, 255, 0.14), transparent 45%),
        var(--bg);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.5;
    }

    main {
      width: min(1080px, 92vw);
      margin: 0 auto;
      padding: 64px 0 80px;
    }

    header {
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .title-logo {
      width: min(420px, 78vw);
      height: auto;
    }

    .subhead {
      margin-top: 8px;
      color: #0FAFFF;
      font-size: clamp(0.95rem, 2vw, 1.08rem);
    }

    section {
      margin-top: 36px;
      padding: 22px;
      background: linear-gradient(165deg, rgba(18, 23, 34, 0.96), rgba(17, 22, 31, 0.88));
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: var(--shadow);
    }

    h2 {
      margin: 0 0 14px;
      font-size: 1.35rem;
      color: #0FAFFF;
      letter-spacing: 0.01em;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .section-avatar {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      object-fit: cover;
      border: 1px solid #3a4762;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 14px;
    }

    .account {
      display: flex;
      flex-direction: column;
      gap: 12px;
      text-decoration: none;
      color: inherit;
      padding: 14px;
      border-radius: 12px;
      background: var(--panel-soft);
      border: 1px solid #33405a;
      transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .account:hover {
      transform: translateY(-2px);
      border-color: var(--accent-strong);
      box-shadow: 0 8px 24px rgba(72, 185, 255, 0.18);
    }

    .account-head {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .platform-icon {
      width: 24px;
      height: 24px;
      color: #dbe8ff;
      opacity: 0.95;
    }

    .platform-icon svg {
      width: 100%;
      height: 100%;
      display: block;
      fill: currentColor;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .handle {
      font-size: 1.12rem;
      font-weight: 650;
      overflow-wrap: anywhere;
    }

    .count-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-top: auto;
      text-align: center;
      width: 100%;
    }

    .count {
      font-size: 1.2rem;
      color: #ffffff;
      font-weight: 700;
      line-height: 1.2;
    }

    .count-label {
      font-size: 0.85rem;
      color: #8895b2;
      font-weight: 400;
    }

    .note {
      margin-top: 24px;
      font-size: 0.86rem;
      color: #8895b2;
    }

    .loading {
      color: #b6c3de;
    }
  </style>
</head>
<body>
  <main>
    <header>
      <img class="title-logo" src="/nwnmedia.svg" alt="NWN Media" />
      <p class="subhead">is a social brand created by Aidan Kellaher.</p>
    </header>

    <section>
      <h2><img class="section-avatar" src="/NWNLogo.webp" alt="Next Week News avatar" />Next Week News</h2>
      <div class="grid">
        <a class="account" href="https://www.tiktok.com/@nextweeknews" target="_blank" rel="noopener" data-platform="tiktok" data-handle="nextweeknews">
          <span class="account-head"><span class="platform-icon" data-icon aria-label="TikTok"><span class="sr-only">TikTok</span></span><span class="handle">@nextweeknews</span></span>
          <span class="count-wrap"><span class="count loading">Loading live count…</span><span class="count-label">followers</span></span>
        </a>
        <a class="account" href="https://www.instagram.com/nextweeknews" target="_blank" rel="noopener" data-platform="instagram" data-handle="nextweeknews">
          <span class="account-head"><span class="platform-icon" data-icon aria-label="Instagram"><span class="sr-only">Instagram</span></span><span class="handle">@nextweeknews</span></span>
          <span class="count-wrap"><span class="count loading">Loading live count…</span><span class="count-label">followers</span></span>
        </a>
        <a class="account" href="https://www.youtube.com/@NextWeekNews" target="_blank" rel="noopener" data-platform="youtube" data-handle="NextWeekNews">
          <span class="account-head"><span class="platform-icon" data-icon aria-label="YouTube"><span class="sr-only">YouTube</span></span><span class="handle">@NextWeekNews</span></span>
          <span class="count-wrap"><span class="count loading">Loading live count…</span><span class="count-label">subscribers</span></span>
        </a>
      </div>
    </section>

    <section>
      <h2><img class="section-avatar" src="/AidanPFP.png" alt="NWN Aidan avatar" />NWN Aidan</h2>
      <div class="grid">
        <a class="account" href="https://www.tiktok.com/@nwnaidan" target="_blank" rel="noopener" data-platform="tiktok" data-handle="nwnaidan">
          <span class="account-head"><span class="platform-icon" data-icon aria-label="TikTok"><span class="sr-only">TikTok</span></span><span class="handle">@nwnaidan</span></span>
          <span class="count-wrap"><span class="count loading">Loading live count…</span><span class="count-label">followers</span></span>
        </a>
        <a class="account" href="https://www.youtube.com/@nwnaidan" target="_blank" rel="noopener" data-platform="youtube" data-handle="nwnaidan">
          <span class="account-head"><span class="platform-icon" data-icon aria-label="YouTube"><span class="sr-only">YouTube</span></span><span class="handle">@nwnaidan</span></span>
          <span class="count-wrap"><span class="count loading">Loading live count…</span><span class="count-label">subscribers</span></span>
        </a>
      </div>
    </section>

    <section>
      <h2><img class="section-avatar" src="/AidanPFP.png" alt="Personal avatar" />Personal</h2>
      <div class="grid">
        <a class="account" href="https://www.tiktok.com/@aidan.kellaher" target="_blank" rel="noopener" data-platform="tiktok" data-handle="aidan.kellaher">
          <span class="account-head"><span class="platform-icon" data-icon aria-label="TikTok"><span class="sr-only">TikTok</span></span><span class="handle">@aidan.kellaher</span></span>
          <span class="count-wrap"><span class="count loading">Loading live count…</span><span class="count-label">followers</span></span>
        </a>
      </div>
    </section>

    <p class="note">Follower/subscriber data uses publicly available page metadata and may be limited by platform privacy or anti-bot protections.</p>
  </main>

  <script>
    const cards = [...document.querySelectorAll('.account')];

    const icons = {
      tiktok: '<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.35V2h-3.2v13.23a2.89 2.89 0 1 1-1.98-2.75V9.24a6.1 6.1 0 1 0 5.18 6.04V8.56a8.02 8.02 0 0 0 4.8 1.6V6.98c-.35 0-.7-.1-1.03-.29Z"/></svg>',
      instagram: '<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2Zm-.2 1.8a3.75 3.75 0 0 0-3.75 3.75v8.9a3.75 3.75 0 0 0 3.75 3.75h8.9a3.75 3.75 0 0 0 3.75-3.75v-8.9a3.75 3.75 0 0 0-3.75-3.75h-8.9Zm9.35 1.55a1.2 1.2 0 1 1 0 2.4 1.2 1.2 0 0 1 0-2.4ZM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 1.8a3.2 3.2 0 1 0 0 6.4 3.2 3.2 0 0 0 0-6.4Z"/></svg>',
      youtube: '<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21.58 7.19a2.98 2.98 0 0 0-2.1-2.1C17.62 4.6 12 4.6 12 4.6s-5.62 0-7.48.5a2.98 2.98 0 0 0-2.1 2.1c-.5 1.86-.5 4.81-.5 4.81s0 2.95.5 4.81a2.98 2.98 0 0 0 2.1 2.1c1.86.5 7.48.5 7.48.5s5.62 0 7.48-.5a2.98 2.98 0 0 0 2.1-2.1c.5-1.86.5-4.81.5-4.81s0-2.95-.5-4.81ZM10.2 15.2V8.8L15.8 12l-5.6 3.2Z"/></svg>',
    };

    cards.forEach((card) => {
      const iconTarget = card.querySelector('[data-icon]');
      const icon = icons[card.dataset.platform];
      if (icon && iconTarget) iconTarget.insertAdjacentHTML('afterbegin', icon);
    });

    const toNum = (v) => {
      if (!v) return NaN;
      const cleaned = v.replace(/,/g, '').trim().toUpperCase();
      const unit = cleaned.slice(-1);
      const base = parseFloat(cleaned);
      if (Number.isNaN(base)) return NaN;
      if (unit === 'K') return Math.round(base * 1_000);
      if (unit === 'M') return Math.round(base * 1_000_000);
      if (unit === 'B') return Math.round(base * 1_000_000_000);
      return Math.round(base);
    };

    const pretty = (n) => new Intl.NumberFormat().format(n);

    const patterns = {
      tiktok: /(\d[\d,.]*\s*[KMB]?)\s*(followers?)/i,
      youtube: /(\d[\d,.]*\s*[KMB]?)\s*(subscribers?)/i,
    };

    const fetchThroughProxy = async (url) => {
      const proxy = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
      const res = await fetch(proxy);
      if (!res.ok) throw new Error(`Fetch failed (${res.status})`);
      return res.text();
    };

    const getInstagramCount = (html) => {
      const jsonKeys = [
        /"edge_followed_by"\s*:\s*\{\s*"count"\s*:\s*(\d+)/i,
        /"followers_count"\s*:\s*(\d+)/i,
        /"followed_by"\s*:\s*\{\s*"count"\s*:\s*(\d+)/i,
      ];
      for (const expr of jsonKeys) {
        const match = html.match(expr);
        if (match) return Number(match[1]);
      }

      const plain = html.replace(/<[^>]+>/g, ' ').replace(/\s+/g, ' ');
      const fallback = plain.match(/(\d[\d,.]*\s*[KMB]?)\s*(followers?)/i);
      if (!fallback) return null;
      const parsed = toNum(fallback[1]);
      return Number.isFinite(parsed) ? parsed : null;
    };

    const getCount = (html, platform) => {
      if (platform === 'instagram') return getInstagramCount(html);
      const plain = html.replace(/<[^>]+>/g, ' ').replace(/\s+/g, ' ');
      const hit = plain.match(patterns[platform]);
      if (!hit) return null;
      const parsed = toNum(hit[1]);
      return Number.isFinite(parsed) ? parsed : null;
    };

    const updateCard = async (card) => {
      const countEl = card.querySelector('.count');
      const platform = card.dataset.platform;
      const url = card.href;

      try {
        const html = await fetchThroughProxy(url);
        const count = getCount(html, platform);
        if (count === null) throw new Error('No count found');
        countEl.textContent = pretty(count);
        countEl.classList.remove('loading');
      } catch {
        countEl.textContent = 'Live count unavailable';
        countEl.classList.remove('loading');
      }
    };

    cards.forEach(updateCard);
  </script>
</body>
</html>
